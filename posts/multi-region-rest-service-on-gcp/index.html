<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Multi Region REST Service on GCP using GitHub Template | Mark Chmarny</title><meta name=keywords content="rest,gcp,gcr,oidc,github,terraform,github"><meta name=description content="I learn best by doing. And recently, most of the projects I&rsquo;ve been building are either REST or gRPC-base services deployed as container images into Cloud Run on GCP. That means that I increasingly find myself recreating a lot of the same infra and app deployment flows."><meta name=author content="Mark Chmarny"><link rel=canonical href=https://blog.chmarny.com/posts/multi-region-rest-service-on-gcp/><link crossorigin=anonymous href=/assets/css/stylesheet.5bef4b698d33ee9d58f22269d129fe3c725b1b3356a4ed1ded10651b773f88c5.css integrity="sha256-W+9LaY0z7p1Y8iJp0Sn+PHJbGzNWpO0d7RBlG3c/iMU=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.chmarny.com/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chmarny.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.chmarny.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.chmarny.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.chmarny.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.chmarny.com/posts/multi-region-rest-service-on-gcp/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><meta property="og:url" content="https://blog.chmarny.com/posts/multi-region-rest-service-on-gcp/"><meta property="og:site_name" content="Mark Chmarny"><meta property="og:title" content="Multi Region REST Service on GCP using GitHub Template"><meta property="og:description" content="I learn best by doing. And recently, most of the projects I’ve been building are either REST or gRPC-base services deployed as container images into Cloud Run on GCP. That means that I increasingly find myself recreating a lot of the same infra and app deployment flows."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-05T15:43:56-08:00"><meta property="article:modified_time" content="2022-01-05T15:43:56-08:00"><meta property="article:tag" content="Rest"><meta property="article:tag" content="Gcp"><meta property="article:tag" content="Gcr"><meta property="article:tag" content="Oidc"><meta property="article:tag" content="Terraform"><meta property="article:tag" content="Github"><meta property="og:image" content="https://blog.chmarny.com/images/site-feature-image.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.chmarny.com/images/site-feature-image.png"><meta name=twitter:title content="Multi Region REST Service on GCP using GitHub Template"><meta name=twitter:description content="I learn best by doing. And recently, most of the projects I&rsquo;ve been building are either REST or gRPC-base services deployed as container images into Cloud Run on GCP. That means that I increasingly find myself recreating a lot of the same infra and app deployment flows."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chmarny.com/posts/"},{"@type":"ListItem","position":2,"name":"Multi Region REST Service on GCP using GitHub Template","item":"https://blog.chmarny.com/posts/multi-region-rest-service-on-gcp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Multi Region REST Service on GCP using GitHub Template","name":"Multi Region REST Service on GCP using GitHub Template","description":"I learn best by doing. And recently, most of the projects I\u0026rsquo;ve been building are either REST or gRPC-base services deployed as container images into Cloud Run on GCP. That means that I increasingly find myself recreating a lot of the same infra and app deployment flows.\n","keywords":["rest","gcp","gcr","oidc","github","terraform","github"],"articleBody":"I learn best by doing. And recently, most of the projects I’ve been building are either REST or gRPC-base services deployed as container images into Cloud Run on GCP. That means that I increasingly find myself recreating a lot of the same infra and app deployment flows.\nOver time, the stack for these services started getting also more complex. Multi-region deployment in Cloud Run, fronted by Load Balancer with custom domain and SSL cert, throttled by Cloud Armor policies, and pushing images to GCR from GitHub action without the need to provision service account keys.\nSo, over the holidays, I’ve decided to automate the provisioning of the entire stack in a GitHub template project so I can quickly bootstrap new services, in a more reproducible fashion, and focus on actually writing the code, not tweaking the infra.\nThe result, restme. It’s a Terraform-based configuration to provision into your GCP project a fully functional, multi-region, REST service with a secure developer release pipeline in GitHub.\nHere is what’s included:\nCloud Run service provisioning Configured in an n number of regions with Custom identity (service account) Sample Secret Manager-based variable Configurable capacity and autoscaling strategy Accessible only by Internal and Load Balancer traffic (no external access) HTTPS Load Balancer with external IP and Custom domain with SSL certificate Cloud Armor policies for throttling and Canary CVE Serverless NEGs config for Cloud Run service in each region Dev and Ops Configuration for Container registry (GCR) Service uptime and SSL cert expiration alerts IODC-based Workload Identity Pool short-lived credentials provider for GitHub Actions Service logging with GCS bucket sink Local test, lint, and validate actions using Makefile GitHub Actions to test each PR and container image build/publish to GCR on git tag The template project also includes Go source code for very rudimentary REST services based on gin framework to expedite bootstrapping new app dev:\n[GET] Request info - client request, headers and environment variables [POST] Echo message - simple echo message This entire setup is available as a template with prerequisites and deployment instructions my GitHub repo. I hope you find it as helpful as I do.\n","wordCount":"354","inLanguage":"en","image":"https://blog.chmarny.com/images/site-feature-image.png","datePublished":"2022-01-05T15:43:56-08:00","dateModified":"2022-01-05T15:43:56-08:00","author":{"@type":"Person","name":"Mark Chmarny"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chmarny.com/posts/multi-region-rest-service-on-gcp/"},"publisher":{"@type":"Organization","name":"Mark Chmarny","logo":{"@type":"ImageObject","url":"https://blog.chmarny.com/favicons/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://blog.chmarny.com/ accesskey=h title="Mark Chmarny (Alt + H)">Mark Chmarny</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.chmarny.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://blog.chmarny.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.chmarny.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.chmarny.com/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://blog.chmarny.com/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.chmarny.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.chmarny.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Multi Region REST Service on GCP using GitHub Template</h1><div class=post-meta><span title='2022-01-05 15:43:56 -0800 -0800'>2022-01-05</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Mark Chmarny</span></div></header><div class=post-content><p>I learn best by doing. And recently, most of the projects I&rsquo;ve been building are either REST or gRPC-base services deployed as container images into Cloud Run on GCP. That means that I increasingly find myself recreating a lot of the same infra and app deployment flows.</p><p>Over time, the stack for these services started getting also more complex. Multi-region deployment in Cloud Run, fronted by Load Balancer with custom domain and SSL cert, throttled by Cloud Armor policies, and pushing images to GCR from GitHub action without the need to provision service account keys.</p><p>So, over the holidays, I&rsquo;ve decided to automate the provisioning of the entire stack in a <a href=https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-template-repository>GitHub template project</a> so I can quickly bootstrap new services, in a more reproducible fashion, and focus on actually writing the code, not tweaking the infra.</p><p>The result, <a href=https://github.com/mchmarny/restme>restme</a>. It&rsquo;s a <a href=https://www.terraform.io/>Terraform-based configuration</a> to provision into your GCP project a fully functional, multi-region, REST service with a secure developer release pipeline in GitHub.</p><p>Here is what&rsquo;s included:</p><ul><li><a href=https://cloud.google.com/run>Cloud Run</a> service provisioning<ul><li>Configured in an n number of regions with</li><li>Custom identity (service account)</li><li>Sample <a href=https://cloud.google.com/secret-manager>Secret Manager</a>-based variable</li><li>Configurable capacity and autoscaling strategy</li><li>Accessible only by Internal and Load Balancer traffic (no external access)</li></ul></li><li><a href=https://cloud.google.com/load-balancing/docs/https/setting-up-https>HTTPS Load Balancer</a> with external IP and<ul><li>Custom domain with SSL certificate</li><li><a href=https://cloud.google.com/armor>Cloud Armor</a> policies for throttling and Canary CVE</li><li>Serverless NEGs config for Cloud Run service in each region</li></ul></li><li>Dev and Ops Configuration for<ul><li>Container registry (GCR)</li><li>Service uptime and SSL cert expiration alerts</li><li><a href=https://docs.github.com/en/actions/deployment/security-hardening-your-deployments>IODC</a>-based <a href=https://cloud.google.com/blog/products/identity-security/enabling-keyless-authentication-from-github-actions>Workload Identity Pool short-lived credentials provider for GitHub Actions</a></li><li>Service logging with GCS bucket sink</li><li>Local test, lint, and validate actions using <a href=https://github.com/mchmarny/restme/blob/main/Makefile>Makefile</a></li><li><a href=https://github.com/mchmarny/restme/tree/main/.github/workflows>GitHub Actions</a> to <a href=https://github.com/mchmarny/restme/blob/main/.github/workflows/test-on-push.yaml>test each PR</a> and <a href=https://github.com/mchmarny/restme/blob/main/.github/workflows/image-on-tag.yaml>container image build/publish</a> to GCR on git tag</li></ul></li></ul><p>The template project also includes Go source code for very rudimentary REST services based on <a href=https://github.com/gin-gonic/gin>gin framework</a> to expedite bootstrapping new app dev:</p><ul><li><strong>[GET] Request info</strong> - client request, headers and environment variables</li><li><strong>[POST] Echo message</strong> - simple echo message</li></ul><p>This entire setup is available as a template with prerequisites and deployment instructions <a href=https://github.com/mchmarny/restme/blob/main/README.md>my GitHub repo</a>. I hope you find it as helpful as I do.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.chmarny.com/tags/rest/>Rest</a></li><li><a href=https://blog.chmarny.com/tags/gcp/>Gcp</a></li><li><a href=https://blog.chmarny.com/tags/gcr/>Gcr</a></li><li><a href=https://blog.chmarny.com/tags/oidc/>Oidc</a></li><li><a href=https://blog.chmarny.com/tags/terraform/>Terraform</a></li><li><a href=https://blog.chmarny.com/tags/github/>Github</a></li></ul><nav class=paginav><a class=prev href=https://blog.chmarny.com/posts/reproducible-github-workflow-openid-connect-for-gcp-using-terraform/><span class=title>« Prev</span><br><span>Reproducible OpenID connect to GCR for GitHub Actions workflows using Terraform</span>
</a><a class=next href=https://blog.chmarny.com/posts/medium-to-hugo-why-and-how/><span class=title>Next »</span><br><span>Medium to GitHub using Hugo - Why and How I Migrated my Blog</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://blog.chmarny.com/>Mark Chmarny</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>