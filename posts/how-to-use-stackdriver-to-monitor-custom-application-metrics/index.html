<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to use Stackdriver to monitor custom application metrics | Mark Chmarny</title><meta name=keywords content="metrics,logging,gcp"><meta name=description content="Google Stackdriver has thousands of build-in metrics to monitor everything from Kubernetes cluster to database or storage. Stackdriver is also not just limited to Google Cloud Platform (GCP), it supports a number of AWS-native services and extensive log monitoring capabilities for a wide array of open source software packages, whether they run in the Cloud or in on premises."><meta name=author content="Mark Chmarny"><link rel=canonical href=https://blog.chmarny.com/posts/how-to-use-stackdriver-to-monitor-custom-application-metrics/><link crossorigin=anonymous href=/assets/css/stylesheet.5bef4b698d33ee9d58f22269d129fe3c725b1b3356a4ed1ded10651b773f88c5.css integrity="sha256-W+9LaY0z7p1Y8iJp0Sn+PHJbGzNWpO0d7RBlG3c/iMU=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.chmarny.com/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chmarny.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.chmarny.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.chmarny.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.chmarny.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.chmarny.com/posts/how-to-use-stackdriver-to-monitor-custom-application-metrics/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><meta property="og:url" content="https://blog.chmarny.com/posts/how-to-use-stackdriver-to-monitor-custom-application-metrics/"><meta property="og:site_name" content="Mark Chmarny"><meta property="og:title" content="How to use Stackdriver to monitor custom application metrics"><meta property="og:description" content="Google Stackdriver has thousands of build-in metrics to monitor everything from Kubernetes cluster to database or storage. Stackdriver is also not just limited to Google Cloud Platform (GCP), it supports a number of AWS-native services and extensive log monitoring capabilities for a wide array of open source software packages, whether they run in the Cloud or in on premises."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-12-27T22:08:13+00:00"><meta property="article:modified_time" content="2017-12-27T22:08:13+00:00"><meta property="article:tag" content="Metrics"><meta property="article:tag" content="Logging"><meta property="article:tag" content="Gcp"><meta property="og:image" content="https://blog.chmarny.com/images/site-feature-image.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.chmarny.com/images/site-feature-image.png"><meta name=twitter:title content="How to use Stackdriver to monitor custom application metrics"><meta name=twitter:description content="Google Stackdriver has thousands of build-in metrics to monitor everything from Kubernetes cluster to database or storage. Stackdriver is also not just limited to Google Cloud Platform (GCP), it supports a number of AWS-native services and extensive log monitoring capabilities for a wide array of open source software packages, whether they run in the Cloud or in on premises."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chmarny.com/posts/"},{"@type":"ListItem","position":2,"name":"How to use Stackdriver to monitor custom application metrics","item":"https://blog.chmarny.com/posts/how-to-use-stackdriver-to-monitor-custom-application-metrics/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to use Stackdriver to monitor custom application metrics","name":"How to use Stackdriver to monitor custom application metrics","description":"Google Stackdriver has thousands of build-in metrics to monitor everything from Kubernetes cluster to database or storage. Stackdriver is also not just limited to Google Cloud Platform (GCP), it supports a number of AWS-native services and extensive log monitoring capabilities for a wide array of open source software packages, whether they run in the Cloud or in on premises.\n","keywords":["metrics","logging","gcp"],"articleBody":"Google Stackdriver has thousands of build-in metrics to monitor everything from Kubernetes cluster to database or storage. Stackdriver is also not just limited to Google Cloud Platform (GCP), it supports a number of AWS-native services and extensive log monitoring capabilities for a wide array of open source software packages, whether they run in the Cloud or in on premises.\nCustom Metrics When developing a solution though, in addition to monitoring the infrastructure and software, you may also want to monitor internal application events, like throughput of specific types of events, multi-step transaction duration or a total end-to-end pipeline performance.\nTo enable this kind of granular and custom monitoring, Stackdriver supports custom metrics. While it’s possible to write those metrics directly against Stackdriver metricDescriptors API, it’s much easier to use the native Client libraryy support provided by Stackdriver in many development languages (C#, GO, Java, Node.js, PHP, Python, Ruby).\nProducer For illustration purposes, let’s assume you want to track special type of messages in your solution.\ndataPoint := \u0026monitoringpb.Point{ Interval: \u0026monitoringpb.TimeInterval{ EndTime: \u0026googlepb.Timestamp{ Seconds: time.Now().Unix() },\t},\tValue: \u0026monitoringpb.TypedValue{ Value: \u0026monitoringpb.TypedValue_Int64Value{ Int64Value: m }, }, } The Stackdriver libraries strongly type the metric (in this case Int64). Also, while normally you will include the timestamp of the time when the event was collected, for simplicity this example we will generate it at sending time.\nYour solution is distributed so in addition to the data point, we will also want to send the event source for each one of the events to allow us to attribute each event source individually.\ntsRequest := \u0026monitoringpb.CreateTimeSeriesRequest{ Name: monitoring.MetricProjectPath(projectID),\tTimeSeries: []*monitoringpb.TimeSeries{ { Metric: \u0026metricpb.Metric{ Type: customMetricType, Labels: map[string]string{ \"instance_id\": sourceID }, },\tResource: \u0026monitoredrespb.MonitoredResource{ Type: \"global\", Labels: map[string]string{ \"project_id\": projectID}, }, Points: []*monitoringpb.Point{dataPoint}, }, }, } Once the payload is prepared, the producer can send it to StackDriver API using a simple command\nif err := monitorClient.CreateTimeSeries(appContext, tsRequest); err != nil { log.Printf(\"Failed to write time series data: %v\", err), } The complete sample of code for the producer along with Dockerfile to build and publish into your Kubernetes cluster is available in this GitHub repository.\nMonitoring (Dashboard) The quickest way to inspect your newly submitted metrics is the StackDriver dashboard. Simply add new chart using the “Custom Metrics” resource type.\nOnce saved this custom metrics appear as a chart. If you have not chosen to aggregate the metric data, each source will be represented individually.\nIncident Management Besides generating nice charts, the StackDriver data is also actionable. You can create notification policy with number of common incident management target options (e.g. PagerDuty, SMS, or Slack) as well as any publically accessible Webhook.\nSimply define a conditions that identify an unhealthy state for a resource or a group of resources, (in our case the custom metric), and create/define notification target which will be notified to let you know when the resource is unhealthy.\nThe one notification target I “enjoy” the most is the Cloud Console Mobile App which is available for both Android and iOS. Using the mobile app you can monitor your GCP Console resources and Stackdriver information.\nYou can find the source code and how to for this post on GitHub.\n","wordCount":"527","inLanguage":"en","image":"https://blog.chmarny.com/images/site-feature-image.png","datePublished":"2017-12-27T22:08:13.48Z","dateModified":"2017-12-27T22:08:13.48Z","author":{"@type":"Person","name":"Mark Chmarny"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chmarny.com/posts/how-to-use-stackdriver-to-monitor-custom-application-metrics/"},"publisher":{"@type":"Organization","name":"Mark Chmarny","logo":{"@type":"ImageObject","url":"https://blog.chmarny.com/favicons/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://blog.chmarny.com/ accesskey=h title="Mark Chmarny (Alt + H)">Mark Chmarny</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.chmarny.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://blog.chmarny.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.chmarny.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.chmarny.com/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://blog.chmarny.com/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.chmarny.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.chmarny.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">How to use Stackdriver to monitor custom application metrics</h1><div class=post-meta><span title='2017-12-27 22:08:13.48 +0000 UTC'>2017-12-27</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span>Mark Chmarny</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#custom-metrics aria-label="Custom Metrics">Custom Metrics</a></li><li><a href=#producer aria-label=Producer>Producer</a></li><li><a href=#monitoring-dashboard aria-label="Monitoring (Dashboard)">Monitoring (Dashboard)</a></li><li><a href=#incident-management aria-label="Incident Management">Incident Management</a></li></ul></div></details></div><div class=post-content><p>Google <a href=https://cloud.google.com/stackdriver/>Stackdriver</a> has thousands of build-in metrics to monitor everything from Kubernetes cluster to database or storage. Stackdriver is also not just limited to Google Cloud Platform (GCP), it supports a number of AWS-native services and extensive log monitoring capabilities for a wide array of open source software packages, whether they run in the Cloud or in on premises.</p><h2 id=custom-metrics>Custom Metrics<a hidden class=anchor aria-hidden=true href=#custom-metrics>#</a></h2><p>When developing a solution though, in addition to monitoring the infrastructure and software, you may also want to monitor internal application events, like throughput of specific types of events, multi-step transaction duration or a total end-to-end pipeline performance.</p><p>To enable this kind of granular and custom monitoring, Stackdriver supports <a href=https://cloud.google.com/monitoring/custom-metrics/creating-metrics>custom metrics</a>. While it’s possible to write those metrics directly against Stackdriver <a href=https://cloud.google.com/monitoring/api/ref_v3/rest/v3/projects.metricDescriptors>metricDescriptors API</a>, it’s much easier to use the native <a href=https://cloud.google.com/logging/docs/reference/libraries>Client library</a>y support provided by Stackdriver in many development languages (C#, GO, Java, Node.js, PHP, Python, Ruby).</p><h2 id=producer>Producer<a hidden class=anchor aria-hidden=true href=#producer>#</a></h2><p>For illustration purposes, let’s assume you want to track special type of messages in your solution.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>dataPoint</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=o>&amp;</span><span class=nx>monitoringpb</span><span class=p>.</span><span class=nx>Point</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Interval</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>monitoringpb</span><span class=p>.</span><span class=nx>TimeInterval</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>EndTime</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>googlepb</span><span class=p>.</span><span class=nx>Timestamp</span><span class=p>{</span><span class=w> </span><span class=nx>Seconds</span><span class=p>:</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Unix</span><span class=p>()</span><span class=w> </span><span class=p>},</span><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>},</span><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Value</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>monitoringpb</span><span class=p>.</span><span class=nx>TypedValue</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nx>Value</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>monitoringpb</span><span class=p>.</span><span class=nx>TypedValue_Int64Value</span><span class=p>{</span><span class=w> </span><span class=nx>Int64Value</span><span class=p>:</span><span class=w> </span><span class=nx>m</span><span class=w> </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>The Stackdriver libraries strongly type the metric (in this case Int64). Also, while normally you will include the timestamp of the time when the event was collected, for simplicity this example we will generate it at sending time.</p><p>Your solution is distributed so in addition to the data point, we will also want to send the event source for each one of the events to allow us to attribute each event source individually.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>tsRequest</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=o>&amp;</span><span class=nx>monitoringpb</span><span class=p>.</span><span class=nx>CreateTimeSeriesRequest</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>Name</span><span class=p>:</span><span class=w> </span><span class=nx>monitoring</span><span class=p>.</span><span class=nf>MetricProjectPath</span><span class=p>(</span><span class=nx>projectID</span><span class=p>),</span><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>TimeSeries</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=o>*</span><span class=nx>monitoringpb</span><span class=p>.</span><span class=nx>TimeSeries</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>Metric</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>metricpb</span><span class=p>.</span><span class=nx>Metric</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nx>Type</span><span class=p>:</span><span class=w> </span><span class=nx>customMetricType</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nx>Labels</span><span class=p>:</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span><span class=w> </span><span class=s>&#34;instance_id&#34;</span><span class=p>:</span><span class=w> </span><span class=nx>sourceID</span><span class=w> </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>},</span><span class=w>			
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>Resource</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>monitoredrespb</span><span class=p>.</span><span class=nx>MonitoredResource</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nx>Type</span><span class=p>:</span><span class=w> </span><span class=s>&#34;global&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nx>Labels</span><span class=p>:</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span><span class=w> </span><span class=s>&#34;project_id&#34;</span><span class=p>:</span><span class=w> </span><span class=nx>projectID</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nx>Points</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=o>*</span><span class=nx>monitoringpb</span><span class=p>.</span><span class=nx>Point</span><span class=p>{</span><span class=nx>dataPoint</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Once the payload is prepared, the producer can send it to StackDriver API using a simple command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>monitorClient</span><span class=p>.</span><span class=nf>CreateTimeSeries</span><span class=p>(</span><span class=nx>appContext</span><span class=p>,</span><span class=w> </span><span class=nx>tsRequest</span><span class=p>);</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nx>log</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Failed to write time series data: %v&#34;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>The complete sample of code for the producer along with Dockerfile to build and publish into your Kubernetes cluster is available in this GitHub <a href=https://github.com/mchmarny/custom-metrics>repository</a>.</p><h2 id=monitoring-dashboard>Monitoring (Dashboard)<a hidden class=anchor aria-hidden=true href=#monitoring-dashboard>#</a></h2><p>The quickest way to inspect your newly submitted metrics is the StackDriver dashboard. Simply add new chart using the &ldquo;Custom Metrics&rdquo; resource type.</p><p><img loading=lazy src=/images/0____J7wbYq2TfuTf6ld.png></p><p>Once saved this custom metrics appear as a chart. If you have not chosen to aggregate the metric data, each source will be represented individually.</p><p><img loading=lazy src=/images/0__UXkmv3PVYfQCA5CW.png></p><h2 id=incident-management>Incident Management<a hidden class=anchor aria-hidden=true href=#incident-management>#</a></h2><p>Besides generating nice charts, the StackDriver data is also actionable. You can create <a href=https://cloud.google.com/monitoring/alerts/>notification policy</a> with number of common incident management <a href=https://cloud.google.com/monitoring/support/notification-options>target options</a> (e.g. PagerDuty, SMS, or Slack) as well as any publically accessible Webhook.</p><p><img loading=lazy src=/images/0__74YEsQoq6MT__Osic.png></p><p>Simply define a conditions that identify an unhealthy state for a resource or a group of resources, (in our case the custom metric), and create/define notification target which will be notified to let you know when the resource is unhealthy.</p><p>The one notification target I &ldquo;enjoy&rdquo; the most is the <a href=https://cloud.google.com/console-app/>Cloud Console Mobile App</a> which is available for both Android and iOS. Using the mobile app you can monitor your GCP Console resources and Stackdriver information.</p><p>You can find the <a href=https://github.com/mchmarny/custom-metrics>source code</a> and how to for this post on GitHub.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.chmarny.com/tags/metrics/>Metrics</a></li><li><a href=https://blog.chmarny.com/tags/logging/>Logging</a></li><li><a href=https://blog.chmarny.com/tags/gcp/>Gcp</a></li></ul><nav class=paginav><a class=prev href=https://blog.chmarny.com/posts/build-modern-serverless-workloads-using-knative-on-kubernetes/><span class=title>« Prev</span><br><span>Build and manage modern serverless workloads using Knative on Kubernetes</span>
</a><a class=next href=https://blog.chmarny.com/posts/using-google-cloud-spanner-to-measure-social-media-influence-over-stock-market/><span class=title>Next »</span><br><span>Using Google Cloud Spanner to measure social media influence over stock market</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://blog.chmarny.com/>Mark Chmarny</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>